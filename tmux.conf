##############################################################################
# 基础配置
##############################################################################

# 把前缀键从 C-b 更改为 C-a
set-option -g prefix C-a
# 释放之前的 Ctrl-b 前缀快捷键
unbind-key C-b
# 确保可以向其它程序发送 Ctrl-A
bind-key C-a send-prefix
# 把窗口的初始索引值从 0 改为 1
set -g base-index 1
# 把面板的初始索引值从 0 改为 1
setw -g pane-base-index 1

# 设定前缀键和命令键之间的延时
set -sg escape-time 1
set -g default-shell /bin/zsh

# 使用 Prefix R 重新加载配置文件
bind-key R source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# vi is good
setw -g mode-keys vi

# 禁用鼠标, 强制纯键盘操作
setw -g mode-mouse off
set -g mouse-select-pane off
set -g mouse-resize-pane off
set -g mouse-select-window off

# 设置默认的终端模式为 256 色模式
set -g default-terminal "screen-256color"

set -g status-utf8 on
bind-key : command-prompt
bind-key r refresh-client
bind-key L clear-history

#bind-key enter next-layout

# 分割窗口
bind-key s split-window -h
bind-key i split-window -v

# 窗口间切换
unbind-key -n k
unbind-key -n j
unbind-key -n h
unbind-key -n l
unbind-key x
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# 调整窗口大小
bind -r K resize-pane -U 5
bind -r J resize-pane -D 5
bind -r H resize-pane -L 5
bind -r L resize-pane -R 5

# 交换两个窗口
bind ^u swapp -U
bind ^d swapp -D

# smart pane switching with awareness of vim splits
bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim$' && tmux send-keys C-h) || tmux select-pane -L"
bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim$' && tmux send-keys C-j) || tmux select-pane -D"
bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim$' && tmux send-keys C-k) || tmux select-pane -U"
bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim$' && tmux send-keys C-l) || tmux select-pane -R"
bind -n C-\ run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim$' && tmux send-keys 'C-\\') || tmux select-pane -l"
bind ^o send-keys 'C-l'

#bind-key C-o rotate-window

bind-key + select-layout main-horizontal
bind-key = select-layout main-vertical
set-window-option -g other-pane-height 25
set-window-option -g other-pane-width 80

bind-key [ copy-mode
bind-key ] paste-buffer

# Setup 'v' to begin selection as in Vim
bind-key -t vi-copy v begin-selection
bind-key -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"
bind-key p paste-buffer

# Update default binding of `Enter` to also use copy-pipe
unbind -t vi-copy Enter
bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"

set-window-option display-panes-time 1500

##############################################################################
# 状态栏
##############################################################################

# 设置状态栏的颜色
set -g status-fg white
set -g status-bg black

# 设置窗口列表的颜色
setw -g window-status-fg cyan
setw -g window-status-bg default
setw -g window-status-attr dim

# 设置活动窗口的颜色
setw -g window-status-current-fg white
setw -g window-status-current-bg blue
setw -g window-status-current-attr bright

# 设置面板和活动面板的颜色
set -g pane-border-fg green
set -g pane-border-bg black
set -g pane-active-border-fg white
set -g pane-active-border-bg yellow

# 设置命令行或消息的颜色
set -g message-fg white
set -g message-bg black
set -g message-attr bright

# 设置状态栏左侧的内容和颜色
set -g status-left-length 40
set -g status-left "#[fg=green]Session: #S "
set -g status-utf8 on

set -g status-right "| #[fg=cyan]%-m月%-d日 %R"

# 状态栏刷新时间
set -g status-interval 10

# 开启活动通知
setw -g monitor-activity on
set -g visual-activity on

# Enable native Mac OS X copy/paste
# set-option -g default-command "/bin/bash -c 'which reattach-to-user-namespace >/dev/null && exec reattach-to-user-namespace $SHELL -l || exec $SHELL -l'"
set -g default-command "/bin/zsh -c 'which reattach-to-user-namespace >/dev/null && exec reattach-to-user-namespace /bin/zsh -l || exec /bin/zsh -l'"

set -g repeat-time 500
